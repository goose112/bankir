import { useState } from "react";
import "./Dashboard.css";

type –û–ø–µ—Ä–∞—Ü–∏—è = {
  —Ç–∏–ø: "–¥–æ—Ö–æ–¥" | "—Ä–∞—Å—Ö–æ–¥";
  –ø–æ–ª—É—á–∞—Ç–µ–ª—å: string;
  —Å—É–º–º–∞: number;
  –¥–∞—Ç–∞: string;
};

const DashboardPage = () => {
  const [–∏–º—è] = useState<string>("–ò–≤–∞–Ω");
  const [–±–∞–ª–∞–Ω—Å, set–ë–∞–ª–∞–Ω—Å] = useState<number>(12500);
  const [–ø–æ–ª—É—á–∞—Ç–µ–ª—å, set–ü–æ–ª—É—á–∞—Ç–µ–ª—å] = useState<string>("");
  const [—Å—É–º–º–∞, set–°—É–º–º–∞] = useState<number>(0);
  const [–æ–ø–µ—Ä–∞—Ü–∏–∏, set–û–ø–µ—Ä–∞—Ü–∏–∏] = useState<–û–ø–µ—Ä–∞—Ü–∏—è[]>([]);
  const [—Ä–∞–∑–¥–µ–ª, set–†–∞–∑–¥–µ–ª] = useState<"–≥–ª–∞–≤–Ω–∞—è" | "–ø–µ—Ä–µ–≤–æ–¥" | "–∞–Ω–∞–ª–∏—Ç–∏–∫–∞">(
    "–≥–ª–∞–≤–Ω–∞—è"
  );

  const –≤—ã–ø–æ–ª–Ω–∏—Ç—å–ü–µ—Ä–µ–≤–æ–¥ = () => {
    if (!–ø–æ–ª—É—á–∞—Ç–µ–ª—å || —Å—É–º–º–∞ <= 0) {
      alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ");
      return;
    }

    if (—Å—É–º–º–∞ > –±–∞–ª–∞–Ω—Å) {
      alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤");
      return;
    }

    const –Ω–æ–≤–∞—è–û–ø–µ—Ä–∞—Ü–∏—è: –û–ø–µ—Ä–∞—Ü–∏—è = {
      —Ç–∏–ø: "—Ä–∞—Å—Ö–æ–¥",
      –ø–æ–ª—É—á–∞—Ç–µ–ª—å,
      —Å—É–º–º–∞,
      –¥–∞—Ç–∞: new Date().toLocaleDateString(),
    };

    set–ë–∞–ª–∞–Ω—Å(–±–∞–ª–∞–Ω—Å - —Å—É–º–º–∞);
    set–û–ø–µ—Ä–∞—Ü–∏–∏([–Ω–æ–≤–∞—è–û–ø–µ—Ä–∞—Ü–∏—è, ...–æ–ø–µ—Ä–∞—Ü–∏–∏]);
    set–ü–æ–ª—É—á–∞—Ç–µ–ª—å("");
    set–°—É–º–º–∞(0);
    alert("–ü–µ—Ä–µ–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω ‚úÖ");
  };

  const –æ–±—â–∏–π–î–æ—Ö–æ–¥ = –æ–ø–µ—Ä–∞—Ü–∏–∏
    .filter((o) => o.—Ç–∏–ø === "–¥–æ—Ö–æ–¥")
    .reduce((acc, o) => acc + o.—Å—É–º–º–∞, 0);

  const –æ–±—â–∏–π–†–∞—Å—Ö–æ–¥ = –æ–ø–µ—Ä–∞—Ü–∏–∏
    .filter((o) => o.—Ç–∏–ø === "—Ä–∞—Å—Ö–æ–¥")
    .reduce((acc, o) => acc + o.—Å—É–º–º–∞, 0);

  const –≤—ã–π—Ç–∏ = () => {
    alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞");
    window.location.reload();
  };

  return (
    <div className="layout">
      <aside className="sidebar">
        <h2 className="logo">–ú–æ–π–ë–∞–Ω–∫</h2>
        <ul className="nav">
          <li onClick={() => set–†–∞–∑–¥–µ–ª("–≥–ª–∞–≤–Ω–∞—è")}>–ì–ª–∞–≤–Ω–∞—è</li>
          <li onClick={() => set–†–∞–∑–¥–µ–ª("–ø–µ—Ä–µ–≤–æ–¥")}>–ü–µ—Ä–µ–≤–æ–¥</li>
          <li onClick={() => set–†–∞–∑–¥–µ–ª("–∞–Ω–∞–ª–∏—Ç–∏–∫–∞")}>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</li>
          <li onClick={–≤—ã–π—Ç–∏}>–í—ã–π—Ç–∏</li>
        </ul>
      </aside>

      <main className="main">
        <h1>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {–∏–º—è} üëã</h1>

        {—Ä–∞–∑–¥–µ–ª === "–≥–ª–∞–≤–Ω–∞—è" && (
          <>
            <div className="balance-box">
              <span>–í–∞—à –±–∞–ª–∞–Ω—Å</span>
              <h2>{–±–∞–ª–∞–Ω—Å.toLocaleString()} ‚ÇΩ</h2>
            </div>

            <div className="history-box">
              <h3>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
              {–æ–ø–µ—Ä–∞—Ü–∏–∏.length === 0 && <p>–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>}
              {–æ–ø–µ—Ä–∞—Ü–∏–∏.map((op, index) => (
                <div key={index} className="history-item">
                  <span>{op.–ø–æ–ª—É—á–∞—Ç–µ–ª—å}</span>
                  <span className="negative">
                    -{op.—Å—É–º–º–∞} ‚ÇΩ
                  </span>
                  <span>{op.–¥–∞—Ç–∞}</span>
                </div>
              ))}
            </div>
          </>
        )}

        {—Ä–∞–∑–¥–µ–ª === "–ø–µ—Ä–µ–≤–æ–¥" && (
          <div className="form-box">
            <h3>–ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>

            <input
              type="text"
              placeholder="–ö–æ–º—É –ø–µ—Ä–µ–≤–æ–¥"
              value={–ø–æ–ª—É—á–∞—Ç–µ–ª—å}
              onChange={(e) => set–ü–æ–ª—É—á–∞—Ç–µ–ª—å(e.target.value)}
            />

            <input
              type="number"
              placeholder="–°—É–º–º–∞"
              value={—Å—É–º–º–∞}
              onChange={(e) => set–°—É–º–º–∞(Number(e.target.value))}
            />

            <button className="btn" onClick={–≤—ã–ø–æ–ª–Ω–∏—Ç—å–ü–µ—Ä–µ–≤–æ–¥}>
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å
            </button>
          </div>
        )}

        {—Ä–∞–∑–¥–µ–ª === "–∞–Ω–∞–ª–∏—Ç–∏–∫–∞" && (
          <div className="analytics-box">
            <h3>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
            <p>–û–±—â–∏–π –¥–æ—Ö–æ–¥: {–æ–±—â–∏–π–î–æ—Ö–æ–¥} ‚ÇΩ</p>
            <p>–û–±—â–∏–π —Ä–∞—Å—Ö–æ–¥: {–æ–±—â–∏–π–†–∞—Å—Ö–æ–¥} ‚ÇΩ</p>
            <p>–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {–±–∞–ª–∞–Ω—Å} ‚ÇΩ</p>
          </div>
        )}
      </main>
    </div>
  );
};

export default DashboardPage;